<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Pack-o-Mat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 30px auto;
      padding: 20px;
      background: #f4faff;
      border-radius: 10px;
    }
    h1 { text-align: center; color: #007acc; }
    label { margin-top: 15px; display: block; font-weight: bold; }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      font-size: 1em;
    }
    button {
      margin-top: 10px;
      padding: 10px 15px;
      font-size: 1em;
      background: #007acc;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover { background: #005fa3; }
    #packliste, #gespeicherteListen {
      margin-top: 30px;
      background: #e6f7ff;
      padding: 15px;
      border-radius: 8px;
    }
    ul { list-style: none; padding: 0; }
    li { margin-bottom: 10px; }
    .zusatz, .speichern, .teilen { margin-top: 20px; }
  </style>
</head>
<body>

<h1>Pack-o-Mat</h1>

<label>Reisedatum:</label>
<input type="date" id="datum" />

<label>Reisedauer (Tage):</label>
<input type="number" id="tage" min="1" value="1" />

<label>Unterkunft:</label>
<select id="unterkunft">
  <option value="hotel">Hotel / Ferienwohnung</option>
  <option value="zelt">Zelt / Camping</option>
</select>

<label>Klima:</label>
<select id="klima">
  <option value="hei√ü">Hei√ü</option>
  <option value="warm">Warm</option>
  <option value="mittel">Mittel</option>
  <option value="kalt">Kalt</option>
</select>

<label>Gel√§ndeart:</label>
<select id="gelaende">
  <option value="flach">Flach</option>
  <option value="huegelig">H√ºgelig</option>
  <option value="bergig">Bergig</option>
  <option value="stadt">Stadt</option>
  <option value="wald">Waldgebiet</option>
</select>

<button onclick="erstellePackliste()">Packliste erstellen</button>

<div class="zusatz">
  <label>Eigenes Teil hinzuf√ºgen:</label>
  <input type="text" id="eigenesItem" placeholder="z. B. Lieblingskuscheltier">
  <button onclick="eigenesTeilHinzufuegen()">Hinzuf√ºgen</button>
</div>

<div class="speichern">
  <label>Packliste speichern als:</label>
  <input type="text" id="listenName" placeholder="z. B. Italien 2025">
  <button onclick="speicherePackliste()">Speichern</button>
</div>

<div class="teilen">
  <button onclick="teilePackliste()">Packliste teilen</button>
  <p id="shareLink"></p>
</div>

<div id="packliste"></div>

<div id="gespeicherteListen">
  <h3>Gespeicherte Packlisten:</h3>
  <ul id="alleListen"></ul>
</div>

<script>
let liste = [];
let eigeneDaten = JSON.parse(localStorage.getItem("eigeneSachen") || "{}");

function getJahreszeitVonBis(start, tage) {
  const monate = new Set();
  const d = new Date(start);
  for (let i = 0; i < tage; i++) {
    monate.add(d.getMonth());
    d.setDate(d.getDate() + 1);
  }
  return [...new Set([...monate].map(m =>
    m >= 2 && m <= 4 ? "fr√ºhling" :
    m >= 5 && m <= 7 ? "sommer" :
    m >= 8 && m <= 10 ? "herbst" : "winter"
  ))];
}

function erstellePackliste() {
  const datum = document.getElementById("datum").value;
  const tage = parseInt(document.getElementById("tage").value);
  const unterkunft = document.getElementById("unterkunft").value;
  const gelaende = document.getElementById("gelaende").value;
  const klima = document.getElementById("klima").value;

  if (!datum || tage < 1) return alert("Bitte g√ºltige Daten eingeben.");

  const jahreszeiten = getJahreszeitVonBis(new Date(datum), tage);
  liste = [];

  liste.push(`Unterw√§sche (${tage}x)`, `Socken (${tage}x)`, "Zahnb√ºrste & Zahnpasta", "Ladekabel", "Reisedokumente");

  if (jahreszeiten.includes("sommer")) liste.push("T-Shirts", "Kurze Hosen", "Sonnenbrille");
  if (jahreszeiten.includes("herbst")) liste.push("Pullover", "Regenjacke");
  if (jahreszeiten.includes("winter")) liste.push("Winterjacke", "M√ºtze & Handschuhe");

  // üå°Ô∏è Klima
  if (klima === "hei√ü") liste.push("Sehr leichte Kleidung", "Extra Sonnencreme", "Kappe");
  if (klima === "warm") liste.push("Leichte Jacke");
  if (klima === "mittel") liste.push("Normale Jacke");
  if (klima === "kalt") liste.push("Dicke Jacke", "Thermosocken");

  // üèï Unterkunft
  if (unterkunft === "zelt") liste.push("Zelt", "Schlafsack", "Taschenlampe");

  // üèî Gel√§nde
  if (gelaende === "bergig") liste.push("Wanderschuhe");
  if (gelaende === "stadt") liste.push("Tagesrucksack");
  if (gelaende === "wald") liste.push("Insektenspray");

  const key = jahreszeiten.sort().join("-") + "-" + klima + "-" + unterkunft + "-" + gelaende;
  if (eigeneDaten[key]) liste.push(...eigeneDaten[key]);

  zeigePackliste();
}

function zeigePackliste() {
  document.getElementById("packliste").innerHTML =
    `<h2>Deine Packliste</h2><ul id="liste">${liste.map(i => `<li><input type="checkbox"> ${i}</li>`).join("")}</ul>`;
}

function eigenesTeilHinzufuegen() {
  const wert = document.getElementById("eigenesItem").value.trim();
  if (!wert) return;

  liste.push(wert);
  document.getElementById("liste").innerHTML += `<li><input type="checkbox"> ${wert}</li>`;

  const datum = document.getElementById("datum").value;
  const tage = document.getElementById("tage").value;
  const unterkunft = document.getElementById("unterkunft").value;
  const gelaende = document.getElementById("gelaende").value;
  const klima = document.getElementById("klima").value;
  const jahreszeiten = getJahreszeitVonBis(new Date(datum), tage);

  const key = jahreszeiten.sort().join("-") + "-" + klima + "-" + unterkunft + "-" + gelaende;
  eigeneDaten[key] = [...new Set([...(eigeneDaten[key] || []), wert])];
  localStorage.setItem("eigeneSachen", JSON.stringify(eigeneDaten));
  document.getElementById("eigenesItem").value = "";
}

function speicherePackliste() {
  const name = document.getElementById("listenName").value.trim();
  if (!name) return alert("Name fehlt.");
  const gespeicherte = JSON.parse(localStorage.getItem("alleListen") || "{}");
  gespeicherte[name] = liste;
  localStorage.setItem("alleListen", JSON.stringify(gespeicherte));
  zeigeGespeicherteListen();
}

function zeigeGespeicherteListen() {
  const ul = document.getElementById("alleListen");
  ul.innerHTML = "";
  const gespeicherte = JSON.parse(localStorage.getItem("alleListen") || "{}");
  for (let n in gespeicherte) {
    ul.innerHTML += `<li><button onclick="ladeListe('${n}')">${n}</button></li>`;
  }
}

function ladeListe(name) {
  const gespeicherte = JSON.parse(localStorage.getItem("alleListen") || "{}");
  liste = gespeicherte[name];
  zeigePackliste();
}

function teilePackliste() {
  const url = location.origin + location.pathname + "?share=" + encodeURIComponent(JSON.stringify(liste));
  document.getElementById("shareLink").innerHTML = `<a href="${url}" target="_blank">${url}</a>`;
}

function ladeGeteiltePackliste() {
  const p = new URLSearchParams(location.search);
  if (p.has("share")) {
    liste = JSON.parse(decodeURIComponent(p.get("share")));
    zeigePackliste();
  }
}

zeigeGespeicherteListen();
ladeGeteiltePackliste();
</script>

</body>
</html>
